macro(APPEND_GLOB VAR)
  file(GLOB LOCAL_TMP_VAR ${ARGN})
  list(APPEND ${VAR} ${LOCAL_TMP_VAR})
endmacro()

macro(PPT_POSTPROCESS)
  # ############################################################################
  # Installation instructions

  include(GNUInstallDirs)
  set(INSTALL_CONFIGDIR ${CMAKE_INSTALL_LIBDIR}/cmake/ppt)

  install(
    TARGETS PPT
    EXPORT PPT-targets
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR})

  # This is required so that the exported target has the name JSONUtils and not
  # jsonutils
  set_target_properties(PPT PROPERTIES EXPORT_NAME PPT)

  install(DIRECTORY ${PPT_TOP_SOURCE_DIR}/include/
          DESTINATION ${CMAKE_INSTALL_INCLUDEDIR})
  # Remember to install autogenerated file too
  install(FILES ${PPT_TOP_BUILD_DIR}/src/include/ppt/PPT_config.hpp
          DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/ppt)

  # Export the targets to a script
  install(
    EXPORT PPT-targets
    FILE PPTTargets.cmake
    NAMESPACE PPT::
    DESTINATION ${INSTALL_CONFIGDIR})

  # Create a ConfigVersion.cmake file
  include(CMakePackageConfigHelpers)
  write_basic_package_version_file(
    ${CMAKE_CURRENT_BINARY_DIR}/PPTConfigVersion.cmake
    VERSION ${ppt_VERSION}
    COMPATIBILITY AnyNewerVersion)

  configure_package_config_file(
    ${PPT_TOP_SOURCE_DIR}/cmake/PPTConfig.cmake.in
    ${CMAKE_CURRENT_BINARY_DIR}/PPTConfig.cmake
    INSTALL_DESTINATION ${INSTALL_CONFIGDIR})

  # Install the config, configversion and custom find modules
  install(FILES ${CMAKE_CURRENT_BINARY_DIR}/PPTConfig.cmake
                ${CMAKE_CURRENT_BINARY_DIR}/PPTConfigVersion.cmake
          DESTINATION ${INSTALL_CONFIGDIR})

  # ############################################################################
  # Exporting from the build tree
  export(
    EXPORT PPT-targets
    FILE ${CMAKE_CURRENT_BINARY_DIR}/PPTTargets.cmake
    NAMESPACE PPT::)

  # Register package in the User Package Registry
  export(PACKAGE PPT)

endmacro()
